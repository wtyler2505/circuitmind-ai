# Gitleaks configuration for CircuitMind AI
# https://github.com/gitleaks/gitleaks

title = "CircuitMind AI Secret Scanning"

[extend]
useDefault = true

# Additional rules for project-specific patterns
[[rules]]
id = "gemini-api-key"
description = "Google Gemini / Google AI API Key"
regex = '''AIzaSy[0-9A-Za-z_-]{33}'''
keywords = ["AIzaSy"]

[[rules]]
id = "generic-api-key-assignment"
description = "Generic API key assignment in code"
regex = '''(?i)(?:api[_-]?key|apikey)\s*[:=]\s*['\"][0-9a-zA-Z_\-]{20,}['\"]'''
keywords = ["api_key", "apikey", "API_KEY"]

# Allowlist: files that legitimately reference key patterns without containing secrets
[allowlist]
paths = [
  '''.env\.example$''',
  '''\.gitleaks\.toml$''',
  '''package-lock\.json$''',
]
